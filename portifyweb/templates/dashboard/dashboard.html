{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-50">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ guest.name }}'s Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
      defer
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "DM Sans", sans-serif;
      }
    </style>
  </head>
  <body class="h-full" x-data="dashboard()" x-init="init()">
    <div class="min-h-full">
      <!-- Navigation -->
     <nav class="bg-blue-600 shadow">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex flex-col sm:flex-row items-center justify-between h-16 space-y-2 sm:space-y-0">
      
      <!-- Logo -->
      <div class="flex items-center space-x-2">
        <a href="{% url 'home' %}" class="no-underline">
          <h1 class="text-white font-bold text-2xl">ResumeBuilder</h1>
        </a>
      </div>
      
      <!-- Welcome Message -->
      <div class="flex items-center max-w-full sm:max-w-xs text-right">
        <span class="text-white text-sm sm:text-base whitespace-nowrap">
          Welcome,
        </span>
        <span class="ml-2 text-white font-semibold text-base sm:text-lg truncate" title="{{ display_name }}">
          {{ display_name }}
        </span>
      </div>

    </div>
  </div>
</nav>


      <!-- Main Content -->
      <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Personal Details Section -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">Personal Details</h2>
            <button
              @click="editPersonalDetails = !editPersonalDetails"
              class="text-blue-600 hover:text-blue-800"
            >
              <span x-text="editPersonalDetails ? 'Cancel' : 'Edit'"></span>
            </button>
          </div>

          <div x-show="!editPersonalDetails">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <h3 class="text-sm font-medium text-gray-500">Full Name</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ personal_details.full_name|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">Title</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ personal_details.title|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">Location</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ personal_details.location|default:"Not provided" }}
                </p>
              </div>
              <div class="md:col-span-2">
                <h3 class="text-sm font-medium text-gray-500">Short Bio</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ personal_details.short_bio|default:"Not provided" }}
                </p>
              </div>
            </div>
          </div>

          <div x-show="editPersonalDetails" x-cloak class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label
                  for="full_name"
                  class="block text-sm font-medium text-gray-700"
                  >Full Name</label
                >
                <input
                  type="text"
                  id="full_name"
                  x-model="personalDetails.full_name"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="title"
                  class="block text-sm font-medium text-gray-700"
                  >Title</label
                >
                <input
                  type="text"
                  id="title"
                  x-model="personalDetails.title"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="location"
                  class="block text-sm font-medium text-gray-700"
                  >Location</label
                >
                <input
                  type="text"
                  id="location"
                  x-model="personalDetails.location"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
            </div>
            <div>
              <label
                for="short_bio"
                class="block text-sm font-medium text-gray-700"
                >Short Bio</label
              >
              <textarea
                id="short_bio"
                x-model="personalDetails.short_bio"
                rows="3"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              ></textarea>
            </div>
            <div class="flex justify-end space-x-3">
              <button
                @click="editPersonalDetails = false"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Cancel
              </button>
              <button
                @click="savePersonalDetails()"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Save
              </button>
            </div>
          </div>
        </div>

        <!-- Contact Information Section -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">Contact Information</h2>
            <button
              @click="editContactInfo = !editContactInfo"
              class="text-blue-600 hover:text-blue-800"
            >
              <span x-text="editContactInfo ? 'Cancel' : 'Edit'"></span>
            </button>
          </div>

          <div x-show="!editContactInfo">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <h3 class="text-sm font-medium text-gray-500">Email</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.email|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">Phone</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.phone|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">LinkedIn</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.linkedin|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">GitHub</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.github|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">Twitter</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.twitter|default:"Not provided" }}
                </p>
              </div>
              <div>
                <h3 class="text-sm font-medium text-gray-500">Website</h3>
                <p class="mt-1 text-sm text-gray-900">
                  {{ contact_info.website|default:"Not provided" }}
                </p>
              </div>
            </div>
          </div>

          <div x-show="editContactInfo" x-cloak class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label
                  for="email"
                  class="block text-sm font-medium text-gray-700"
                  >Email</label
                >
                <input
                  type="email"
                  id="email"
                  x-model="contactInfo.email"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="phone"
                  class="block text-sm font-medium text-gray-700"
                  >Phone</label
                >
                <input
                  type="tel"
                  id="phone"
                  x-model="contactInfo.phone"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="linkedin"
                  class="block text-sm font-medium text-gray-700"
                  >LinkedIn</label
                >
                <input
                  type="url"
                  id="linkedin"
                  x-model="contactInfo.linkedin"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="github"
                  class="block text-sm font-medium text-gray-700"
                  >GitHub</label
                >
                <input
                  type="url"
                  id="github"
                  x-model="contactInfo.github"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="twitter"
                  class="block text-sm font-medium text-gray-700"
                  >Twitter</label
                >
                <input
                  type="url"
                  id="twitter"
                  x-model="contactInfo.twitter"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="website"
                  class="block text-sm font-medium text-gray-700"
                  >Website</label
                >
                <input
                  type="url"
                  id="website"
                  x-model="contactInfo.website"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
            </div>
            <div class="flex justify-end space-x-3">
              <button
                @click="editContactInfo = false"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Cancel
              </button>
              <button
                @click="saveContactInfo()"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Save
              </button>
            </div>
          </div>
        </div>

        <!-- Projects Section -->
        <div class="bg-white shadow rounded-lg p-6 mb-6">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">Projects</h2>
            <button
              @click="showAddProject = true"
              class="inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
              Add Project
            </button>
          </div>

          <!-- Add Project Form -->
          <div
            x-show="showAddProject"
            x-cloak
            class="mb-6 border-b border-gray-200 pb-6"
          >
            <h3 class="text-lg font-medium text-gray-900 mb-4">
              Add New Project
            </h3>
            <div class="space-y-4">
              <div>
                <label
                  for="project_title"
                  class="block text-sm font-medium text-gray-700"
                  >Title</label
                >
                <input
                  type="text"
                  id="project_title"
                  x-model="newProject.title"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="project_description"
                  class="block text-sm font-medium text-gray-700"
                  >Description</label
                >
                <textarea
                  id="project_description"
                  x-model="newProject.description"
                  rows="3"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                ></textarea>
              </div>
              <div>
                <label
                  for="project_tech_stack"
                  class="block text-sm font-medium text-gray-700"
                  >Tech Stack</label
                >
                <input
                  type="text"
                  id="project_tech_stack"
                  x-model="newProject.tech_stack"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div>
                <label
                  for="project_link"
                  class="block text-sm font-medium text-gray-700"
                  >Link</label
                >
                <input
                  type="url"
                  id="project_link"
                  x-model="newProject.link"
                  class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                />
              </div>
              <div class="flex justify-end space-x-3">
                <button
                  @click="showAddProject = false; newProject = {}"
                  type="button"
                  class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                >
                  Cancel
                </button>
                <button
                  @click="addProject()"
                  type="button"
                  class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                >
                  Save Project
                </button>
              </div>
            </div>
          </div>

          <!-- Projects List -->
          <div class="space-y-4">
            <template x-for="(project, index) in projects" :key="project.id">
              <div class="border border-gray-200 rounded-lg p-4">
                <div class="flex justify-between items-start">
                  <div>
                    <h3
                      class="text-lg font-medium text-gray-900"
                      x-text="project.title"
                    ></h3>
                    <p
                      class="mt-1 text-sm text-gray-600"
                      x-text="project.tech_stack"
                    ></p>
                  </div>
                  <div class="flex space-x-2">
                    <button
                      @click="editProject(index)"
                      class="text-blue-600 hover:text-blue-800"
                    >
                      Edit
                    </button>
                    <button
                      @click="deleteProject(project.id, index)"
                      class="text-red-600 hover:text-red-800"
                    >
                      Delete
                    </button>
                  </div>
                </div>
                <div class="mt-2">
                  <p
                    class="text-sm text-gray-700"
                    x-text="project.description"
                  ></p>
                  <a
                    :href="project.link"
                    target="_blank"
                    class="mt-2 inline-block text-sm text-blue-600 hover:underline"
                    x-text="project.link"
                    x-show="project.link"
                  ></a>
                </div>

                <!-- Edit Project Form -->
                <div
                  x-show="project.editing"
                  x-cloak
                  class="mt-4 pt-4 border-t border-gray-200"
                >
                  <div class="space-y-4">
                    <div>
                      <label class="block text-sm font-medium text-gray-700"
                        >Title</label
                      >
                      <input
                        type="text"
                        x-model="project.title"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700"
                        >Description</label
                      >
                      <textarea
                        x-model="project.description"
                        rows="3"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                      ></textarea>
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700"
                        >Tech Stack</label
                      >
                      <input
                        type="text"
                        x-model="project.tech_stack"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                      />
                    </div>
                    <div>
                      <label class="block text-sm font-medium text-gray-700"
                        >Link</label
                      >
                      <input
                        type="url"
                        x-model="project.link"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                      />
                    </div>
                    <div class="flex justify-end space-x-3">
                      <button
                        @click="project.editing = false"
                        type="button"
                        class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                      >
                        Cancel
                      </button>
                      <button
                        @click="updateProject(project.id, index)"
                        type="button"
                        class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                      >
                        Save Changes
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </template>

            <div
              x-show="projects.length === 0"
              class="text-center py-4 text-gray-500"
            >
              No projects added yet.
            </div>
          </div>
        </div>

<!-- Skills Section -->
<div class="bg-white shadow rounded-lg p-6 mb-6">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-xl font-bold text-gray-800">Skills</h2>
    <button
      @click="showAddSkill = true"
      class="inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
    >
      Add Skill
    </button>
  </div>

  <!-- Add Skill Form -->
  <div
    x-show="showAddSkill"
    x-cloak
    class="mb-6 border-b border-gray-200 pb-6"
  >
    <h3 class="text-lg font-medium text-gray-900 mb-4">
      Add New Skill
    </h3>
    <div class="space-y-4">
      <div>
        <label
          for="skill_name"
          class="block text-sm font-medium text-gray-700"
          >Skill Name</label
        >
        <input
          type="text"
          id="skill_name"
          x-model="newSkill.name"
          class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
        />
      </div>
      <div>
        <label
          for="skill_level"
          class="block text-sm font-medium text-gray-700"
          >Skill Level (1-10)</label
        >
        <input
          type="number"
          id="skill_level"
          x-model="newSkill.level"
          min="1"
          max="10"
          class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
        />
      </div>
      <div class="flex justify-end space-x-3">
        <button
          @click="showAddSkill = false; newSkill = {}"
          type="button"
          class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
        >
          Cancel
        </button>
        <button
          @click="addSkill()"
          type="button"
          class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
        >
          Save Skill
        </button>
      </div>
    </div>
  </div>

  <!-- Skills List -->
  <div class="space-y-4">
    <template x-for="(skill, index) in skills" :key="skill.id">
      <div class="border border-gray-200 rounded-lg p-4">
        <div class="flex justify-between items-start">
          <div>
            <h3 class="text-lg font-medium text-gray-900" x-text="skill.name"></h3>
            <div class="mt-2">
              <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div 
                  class="bg-blue-600 h-2.5 rounded-full" 
                  :style="'width: ' + (skill.level * 10) + '%'"
                ></div>
              </div>
              <span class="text-xs text-gray-500" x-text="skill.level + '/10'"></span>
            </div>
          </div>
          <div class="flex space-x-2">
            <button
              @click="editSkill(index)"
              class="text-blue-600 hover:text-blue-800"
            >
              Edit
            </button>
            <button
              @click="deleteSkill(skill.id, index)"
              class="text-red-600 hover:text-red-800"
            >
              Delete
            </button>
          </div>
        </div>

        <!-- Edit Skill Form -->
        <div
          x-show="skill.editing"
          x-cloak
          class="mt-4 pt-4 border-t border-gray-200"
        >
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Skill Name</label
              >
              <input
                type="text"
                x-model="skill.name"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700"
                >Skill Level (1-10)</label
              >
              <input
                type="number"
                x-model="skill.level"
                min="1"
                max="10"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
              />
            </div>
            <div class="flex justify-end space-x-3">
              <button
                @click="skill.editing = false"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Cancel
              </button>
              <button
                @click="updateSkill(skill.id, index)"
                type="button"
                class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
              >
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </div>
    </template>

    <div
      x-show="skills.length === 0"
      class="text-center py-4 text-gray-500"
    >
      No skills added yet.
    </div>
  </div>
</div>

    <script>
function dashboard() {
    return {
        // State variables
        editPersonalDetails: false,
        editContactInfo: false,
        showAddProject: false,
        showAddSkill: false,

        // Data models
        personalDetails: {
            full_name: '{{ personal_details.full_name|default:""|escapejs }}',
            title: '{{ personal_details.title|default:""|escapejs }}',
            short_bio: '{{ personal_details.short_bio|default:""|escapejs }}',
            location: '{{ personal_details.location|default:""|escapejs }}'
        },

        contactInfo: {
            email: '{{ contact_info.email|default:""|escapejs }}',
            phone: '{{ contact_info.phone|default:""|escapejs }}',
            linkedin: '{{ contact_info.linkedin|default:""|escapejs }}',
            github: '{{ contact_info.github|default:""|escapejs }}',
            twitter: '{{ contact_info.twitter|default:""|escapejs }}',
            website: '{{ contact_info.website|default:""|escapejs }}'
        },

        projects: [
            {% for project in projects %}
            {
                id: '{{ project.id }}',
                title: '{{ project.title|default:""|escapejs }}',
                description: '{{ project.description|default:""|escapejs }}',
                tech_stack: '{{ project.tech_stack|default:""|escapejs }}',
                link: '{{ project.link|default:""|escapejs }}',
                editing: false
            },
            {% endfor %}
        ],

        skills: [
            {% for skill in skills %}
            {
                id: '{{ skill.id }}',
                name: '{{ skill.name|escapejs }}',
                level: {{ skill.level|default:5 }},
                editing: false
            },
            {% endfor %}
        ],

        newProject: {
            title: '',
            description: '',
            tech_stack: '',
            link: ''
        },

        newSkill: {
            name: '',
            level: 5
        },

        // Initialization
        init() {
            // Any initialization logic can go here
        },

        // Personal Details Methods
        savePersonalDetails() {
            fetch('/save_personal_details/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify(this.personalDetails)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    this.editPersonalDetails = false;
                    location.reload();
                }
            });
        },

        // Contact Info Methods
        saveContactInfo() {
            fetch('/save_contact_info/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify(this.contactInfo)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    this.editContactInfo = false;
                    location.reload();
                }
            });
        },

        // Project Methods
        addProject() {
            fetch('/add_project/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify(this.newProject)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    location.reload();
                }
            });
        },

        editProject(index) {
            this.projects[index].editing = true;
        },

        updateProject(projectId, index) {
            const project = this.projects[index];

            fetch(`/update_project/${projectId}/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    title: project.title,
                    description: project.description,
                    tech_stack: project.tech_stack,
                    link: project.link
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    location.reload();
                }
            });
        },

        deleteProject(projectId, index) {
            if (confirm('Are you sure you want to delete this project?')) {
                fetch(`/delete_project/${projectId}/`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        location.reload();
                    }
                });
            }
        },

        // Skill Methods
        addSkill() {
            if (!this.newSkill.name.trim()) {
                alert('Please enter a skill name');
                return;
            }

            fetch('/add_skill/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify(this.newSkill)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    this.showAddSkill = false;
                    this.newSkill = { name: '', level: 5 };
                    location.reload();
                }
            });
        },

        editSkill(index) {
            this.skills[index].editing = true;
        },

        updateSkill(skillId, index) {
            const skill = this.skills[index];

            fetch(`/update_skill/${skillId}/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({
                    name: skill.name,
                    level: skill.level
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    location.reload();
                }
            });
        },

        deleteSkill(skillId, index) {
            if (confirm('Are you sure you want to delete this skill?')) {
                fetch(`/delete_skill/${skillId}/`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        location.reload();
                    }
                });
            }
        },

        // Utility Methods
        validateSkillLevel(level) {
            const num = parseInt(level);
            return !isNaN(num) && num >= 1 && num <= 10;
        }
    }
}
    </script>
  </body>
</html>
